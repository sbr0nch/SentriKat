@version: 4.6
@include "scl.conf"

# SentriKat SIEM Test Receiver
# Shows all incoming syslog messages to stdout (visible via docker logs)

source s_network {
    network(
        transport("udp")
        port(514)
    );
    network(
        transport("tcp")
        port(514)
    );
};

destination d_stdout {
    file("/dev/stdout");
};

destination d_file {
    file("/var/log/sentrikat-siem.log"
        template("${ISODATE} ${HOST} ${PROGRAM} ${MSG}\n")
    );
};

log {
    source(s_network);
    destination(d_stdout);
    destination(d_file);
};
