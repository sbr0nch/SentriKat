# Copy this file to .env and update the values

# ============================================================================
# FLASK CONFIGURATION
# ============================================================================

# SECRET_KEY - REQUIRED
# This is a cryptographically secure random string used by Flask to:
# - Sign session cookies to prevent tampering
# - Encrypt sensitive data in cookies
# - Provide CSRF protection
#
# To generate a secure SECRET_KEY, run: python generate_secret_key.py
# IMPORTANT: Never commit your SECRET_KEY to version control!
SECRET_KEY=your-secret-key-here-change-in-production

# Flask environment (development or production)
FLASK_ENV=production

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# Database URL (SQLite by default, can use PostgreSQL for production)
DATABASE_URL=sqlite:///sentrikat.db
# For PostgreSQL: postgresql://user:password@localhost/sentrikat

# ============================================================================
# CISA KEV SYNC CONFIGURATION
# ============================================================================

# CISA KEV Feed URL (shouldn't need to change)
CISA_KEV_URL=https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json

# Daily sync schedule (24-hour format, UTC time)
SYNC_HOUR=2
SYNC_MINUTE=0

# ============================================================================
# NVD API CONFIGURATION (For CVSS Score Enrichment)
# ============================================================================

# Get your free API key from: https://nvd.nist.gov/developers/request-an-api-key
# Without API key: 5 requests per 30 seconds
# With API key: 50 requests per 30 seconds
NVD_API_KEY=your-nvd-api-key-here

# ============================================================================
# SMTP CONFIGURATION (For Email Alerts)
# ============================================================================

# SMTP Server Settings
SMTP_SERVER=smtp.yourcompany.com
SMTP_PORT=587
SMTP_USERNAME=your-email@yourcompany.com
SMTP_PASSWORD=your-smtp-password
SMTP_FROM_EMAIL=noreply@yourcompany.com
SMTP_FROM_NAME=SentriKat Security Alerts
SMTP_USE_TLS=true

# For Gmail:
# SMTP_SERVER=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@gmail.com
# SMTP_PASSWORD=your-app-password  # Use App Password, not regular password
# SMTP_USE_TLS=true

# For Office 365:
# SMTP_SERVER=smtp.office365.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@yourcompany.com
# SMTP_PASSWORD=your-password
# SMTP_USE_TLS=true

# ============================================================================
# AUTHENTICATION CONFIGURATION
# ============================================================================

# Enable authentication (true/false)
# Set to 'false' for open access (default)
# Set to 'true' to require login
ENABLE_AUTH=false

# ============================================================================
# LDAP / ACTIVE DIRECTORY CONFIGURATION (Optional)
# ============================================================================

# Only configure if using LDAP authentication (ENABLE_AUTH=true)
# For users with auth_type='ldap' in the database

# LDAP Server URL (include protocol and port)
# Examples:
#   ldap://dc3.bonelabs.com:389
#   ldaps://dc3.bonelabs.com:636  (for SSL/TLS)
LDAP_SERVER=ldap://dc3.bonelabs.com:389

# Base DN - Where to search for users in Active Directory
# This is the root of your AD domain
LDAP_BASE_DN=DC=bonelabs,DC=com

# Bind DN - Service account for searching users
# This account needs read permissions in AD
LDAP_BIND_DN=CN=AD LDAP Bind Authentidiktator,OU=Service Accounts,OU=Benutzer,OU=zso,DC=bonelabs,DC=com

# Bind Password - Password for the service account
LDAP_BIND_PW=your-service-account-password

# Search Filter - How to find users (use {username} as placeholder)
# Default searches by sAMAccountName (Windows username)
LDAP_SEARCH_FILTER=(sAMAccountName={username})

# Alternative filters:
# Search by UPN: (userPrincipalName={username}@bonelabs.com)
# Search by CN: (cn={username})
# Search multiple: (|(sAMAccountName={username})(mail={username}))

# ============================================================================
# PROXY CONFIGURATION (Optional)
# ============================================================================

# Proxy settings for accessing external APIs (CISA, NVD, etc.)
# Only needed if behind a corporate proxy

# HTTP_PROXY=http://proxy.bonelabs.com:3128
# HTTPS_PROXY=http://proxy.bonelabs.com:3128
# NO_PROXY=localhost,127.0.0.1,.bonelabs.com
