# Investigation: CVE-2026-2441 Not Appearing in SentriKat

**Date:** 2026-02-16
**CVE:** CVE-2026-2441 (Chrome 0-day — Use after free in CSS, CVSS 8.8 HIGH)
**Status:** NOT VISIBLE in SentriKat — root cause identified (3 compounding issues)

---

## Scenario

A Chrome 0-day (CVE-2026-2441) was dropped on 2026-02-13. We expected it to appear in SentriKat after running sync and admintools-remap. It did not appear.

## What We Did

1. Started the SentriKat server
2. Ran a **sync** (UI button / `POST /api/sync`)
3. Ran **admintools-remap** (`POST /api/products/apply-cpe` + `POST /api/products/rematch`)
4. CVE-2026-2441 still does not appear in the dashboard

## What We Found

Ran the NVD check manually:
```bash
curl -s "https://services.nvd.nist.gov/rest/json/cves/2.0?cveId=CVE-2026-2441" | python3 -m json.tool
```

**NVD HAS the CVE.** Key details:
- `vulnStatus: "Awaiting Analysis"` — NVD received it but hasn't fully analyzed it
- `baseScore: 8.8`, `baseSeverity: "HIGH"` (from Secondary/ADP source, not NVD primary)
- `configurations: MISSING` — **no CPE version range data** because NVD hasn't analyzed it
- `published: 2026-02-13T19:17:31` — 3 days ago
- Description: *"Use after free in CSS in Google Chrome prior to 145.0.7632.75"*

**CISA KEV:** Does NOT have it yet (confirmed).

## Root Cause — 3 Compounding Issues

There are THREE separate problems that all prevent this CVE from appearing.

---

### Problem 1: Manual sync does NOT trigger NVD import

**File:** `app/routes.py:3881` — `trigger_sync()` only calls `sync_cisa_kev()`

The "Sync" button / `POST /api/sync` only runs the CISA KEV sync. It does **NOT** call `sync_nvd_recent_cves()`. The NVD import is a separate scheduled job that runs every 2 hours.

Since CISA KEV doesn't have CVE-2026-2441, the manual sync finds nothing. The NVD scheduled job (`sync_nvd_recent_cves`) runs on its own schedule and might not have fired yet if the server just started.

**Impact:** CVE-2026-2441 may not even exist in the Vulnerability table yet.

**Evidence:**
```python
# routes.py:3881-3889
@bp.route('/api/sync', methods=['POST'])
def trigger_sync():
    result = sync_cisa_kev()   # ← Only CISA KEV, NOT NVD
    return jsonify(result)
```

---

### Problem 2: NVD import stores vendor/product as "Unknown"

**File:** `app/cisa_sync.py:1121-1167`

When `sync_nvd_recent_cves()` does run and imports CVE-2026-2441, NVD returns no `configurations` block (because `vulnStatus: "Awaiting Analysis"`). The code extracts vendor/product from CPE URIs inside `configurations`:

```python
# cisa_sync.py:1121-1132
for config in cve_data.get('configurations', []):   # ← EMPTY, loop never executes
    for node in config.get('nodes', []):
        for match in node.get('cpeMatch', []):
            ...
            vendor = parsed['vendor']
            product = parsed['product']

# Result: vendor='', product='' → stored as 'Unknown'
vuln = Vulnerability(
    vendor_project=vendor or 'Unknown',   # ← 'Unknown'
    product=product or 'Unknown',          # ← 'Unknown'
)
```

The description clearly says "Google Chrome" but the code doesn't parse the description — it only extracts vendor/product from CPE data that doesn't exist yet.

**Impact:** Even keyword matching against "Google" / "Chrome" fails because the Vulnerability record says vendor='Unknown', product='Unknown'.

Also: since `configurations` is empty, `cpe_entries = []`, so `set_cpe_entries()` is never called → `cpe_data = NULL`, `cpe_fetched_at = NULL`.

---

### Problem 3: CPE fetch marks "Awaiting Analysis" as "authoritatively not affected"

**File:** `app/cisa_sync.py:395-420` and `app/filters.py:119-132`

After the CVE is imported (with `cpe_data = NULL`), the next `fetch_cpe_version_data()` call queries NVD for CPE configurations:

```python
# cisa_sync.py:416-419
if cpe_entries:
    vuln.set_cpe_entries(cpe_entries)
else:
    # Mark as checked even if no CPE data found
    vuln.cpe_data = '[]'                         # ← Empty
    vuln.cpe_fetched_at = datetime.utcnow()      # ← STAMPED as "checked"
```

NVD returns no CPE data (still "Awaiting Analysis"), so the code sets `cpe_data = '[]'` and stamps `cpe_fetched_at`. This is intended to mean "NVD has no CPE data for this CVE."

Then during matching:

```python
# filters.py:119-132
else:   # No CPE entries
    if vulnerability.cpe_fetched_at:            # ← IS set (from fetch above)
        # NVD was already queried — no CPE data exists for this CVE.
        # Don't fall back to text matching; NVD is authoritative.
        return [], None, None                   # ← NO MATCH, EVER
```

**The code cannot distinguish between:**
- "NVD analyzed this CVE and confirmed it affects no CPE products" (legitimate)
- "NVD hasn't analyzed this CVE yet" (`vulnStatus: Awaiting Analysis` — temporary)

Once `cpe_fetched_at` is stamped, the CVE is permanently treated as "affects nothing" and will NEVER match any product. Even when NVD later completes analysis and adds CPE data, SentriKat won't re-fetch because `cpe_data` is not NULL anymore (it's `'[]'`).

**This is the fatal issue.** The CVE gets stuck in a permanent "not affected" state.

---

## Complete Failure Chain

```
1. User clicks Sync
   └─ Only runs sync_cisa_kev() → CVE not in CISA KEV → nothing imported

2. NVD scheduled job eventually runs (every 2h)
   └─ Finds CVE-2026-2441 in NVD (HIGH severity, published Feb 13)
   └─ vulnStatus = "Awaiting Analysis" → passes filter (not Rejected/Disputed)
   └─ configurations = EMPTY → vendor='Unknown', product='Unknown', cpe_entries=[]
   └─ Vulnerability created with NO CPE data, NO useful vendor/product

3. fetch_cpe_version_data() runs (during next sync_cisa_kev)
   └─ Queries NVD for CPE configurations → returns nothing (still Awaiting Analysis)
   └─ Sets cpe_data='[]', cpe_fetched_at=NOW
   └─ CVE is now permanently marked as "checked, no CPE data"

4. rematch_all_products() runs
   └─ Chrome product (cpe: google:chrome) checked against CVE-2026-2441
   └─ CVE has empty cpe_entries + cpe_fetched_at is set
   └─ filters.py:129-132 → "NVD is authoritative, no match" → SKIP
   └─ CVE never appears on dashboard

5. Even days later when NVD completes analysis:
   └─ fetch_cpe_version_data() filters by cpe_data == NULL
   └─ CVE-2026-2441 has cpe_data='[]' (not NULL) → SKIPPED
   └─ CPE data is NEVER re-fetched → CVE remains invisible forever
```

## Recommended Fixes

### Fix 1 (Quick): Add NVD import to manual sync
In `routes.py`, make `trigger_sync()` also call `sync_nvd_recent_cves()` so the manual sync button catches CVEs from NVD, not just CISA KEV.

### Fix 2 (Critical): Don't stamp cpe_fetched_at for "Awaiting Analysis" CVEs
In `fetch_cpe_version_data()`, when NVD returns no CPE data, check if the CVE's NVD status is "Awaiting Analysis". If so, leave `cpe_data = NULL` and `cpe_fetched_at = NULL` so it gets retried on the next fetch cycle.

### Fix 3 (Critical): Add a re-fetch mechanism for stale empty CPE data
CVEs with `cpe_data = '[]'` should be periodically re-checked (e.g., daily or weekly) in case NVD has since completed analysis. The current `fetch_cpe_version_data()` filters by `cpe_data == NULL` only, so once stamped, a CVE is never re-checked.

### Fix 4 (Enhancement): Parse vendor/product from description as fallback
When NVD has no `configurations` block, extract vendor/product from the description text (e.g., "Google Chrome" from "Use after free in CSS in Google Chrome prior to 145.0.7632.75"). This enables keyword matching as a safety net.

### Fix 5 (Enhancement): Add manual CVE lookup by ID
Add an admin endpoint that accepts a CVE ID, queries NVD on-demand, and imports it immediately — regardless of whether it's in CISA KEV or the scheduled NVD sync window.

## Diagnostic Commands

### Check if CVE exists in SentriKat database
```bash
# Via Flask shell or database query:
SELECT cve_id, vendor_project, product, cpe_data, cpe_fetched_at, source
FROM vulnerabilities WHERE cve_id = 'CVE-2026-2441';
```

### Check NVD status
```bash
curl -s "https://services.nvd.nist.gov/rest/json/cves/2.0?cveId=CVE-2026-2441" | python3 -c "
import json, sys
data = json.load(sys.stdin)
cve = data['vulnerabilities'][0]['cve']
print(f'Status: {cve[\"vulnStatus\"]}')
print(f'Has configurations: {bool(cve.get(\"configurations\"))}')
print(f'CVSS: {cve.get(\"metrics\", {}).get(\"cvssMetricV31\", [{}])[0].get(\"cvssData\", {}).get(\"baseScore\", \"N/A\")}')
"
```

### Check if Chrome products have CPE in SentriKat
```bash
SELECT id, product_name, vendor, cpe_vendor, cpe_product, version
FROM products WHERE cpe_product = 'chrome' OR product_name ILIKE '%chrome%';
```

### Check last NVD sync time
```bash
SELECT key, value FROM system_settings WHERE key = 'last_nvd_cve_sync';
```

### Force NVD sync manually (if endpoint existed)
Currently no endpoint. Would need: `POST /api/sync/nvd` → calls `sync_nvd_recent_cves()`.

## Unrelated: Portal 520 Error

Current known issue — portal endpoint (`license.sentrikat.com/api/v1/releases/latest`) not built yet. Non-blocking.
